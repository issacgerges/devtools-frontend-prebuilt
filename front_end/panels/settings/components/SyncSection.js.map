{"version":3,"file":"SyncSection.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/settings/components/SyncSection.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../../core/common/common.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport type * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as Settings from '../../../ui/components/settings/settings.js';\n\nimport syncSectionStyles from './syncSection.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Text shown to the user in the Settings UI. 'This setting' refers\n   * to a checkbox that is disabled.\n   */\n  syncDisabled: 'To turn this setting on, you must enable Chrome sync.',\n  /**\n   * @description Text shown to the user in the Settings UI. 'This setting' refers\n   * to a checkbox that is disabled.\n   */\n  preferencesSyncDisabled: 'To turn this setting on, you must first enable settings sync in Chrome.',\n  /**\n   * @description Label for a link that take the user to the \"Sync\" section of the\n   * chrome settings. The link is shown in the DevTools Settings UI.\n   */\n  settings: 'Go to Settings',\n  /**\n   * @description Label for the account email address. Shown in the DevTools Settings UI in\n   * front of the email address currently used for Chrome Sync.\n   */\n  signedIn: 'Signed into Chrome as:',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/settings/components/SyncSection.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface SyncSectionData {\n  syncInfo: Host.InspectorFrontendHostAPI.SyncInformation;\n  syncSetting: Common.Settings.Setting<boolean>;\n}\n\nexport class SyncSection extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-sync-section`;\n  private readonly shadow = this.attachShadow({mode: 'open'});\n\n  private syncInfo: Host.InspectorFrontendHostAPI.SyncInformation = {isSyncActive: false};\n  private syncSetting?: Common.Settings.Setting<boolean>;\n\n  private boundRender = this.render.bind(this);\n\n  connectedCallback(): void {\n    this.shadow.adoptedStyleSheets = [syncSectionStyles];\n  }\n\n  set data(data: SyncSectionData) {\n    this.syncInfo = data.syncInfo;\n    this.syncSetting = data.syncSetting;\n    ComponentHelpers.ScheduledRender.scheduleRender(this, this.boundRender);\n  }\n\n  private render(): void {\n    if (!this.syncSetting) {\n      throw new Error('SyncSection not properly initialized');\n    }\n\n    const checkboxDisabled = !this.syncInfo.isSyncActive || !this.syncInfo.arePreferencesSynced;\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    LitHtml.render(LitHtml.html`\n      <fieldset>\n        <legend>${Common.Settings.getLocalizedSettingsCategory(Common.Settings.SettingCategory.SYNC)}</legend>\n        ${renderAccountInfoOrWarning(this.syncInfo)}\n        <${Settings.SettingCheckbox.SettingCheckbox.litTagName} .data=${\n            {setting: this.syncSetting, disabled: checkboxDisabled} as Settings.SettingCheckbox.SettingCheckboxData}>\n        </${Settings.SettingCheckbox.SettingCheckbox.litTagName}>\n      </fieldset>\n    `, this.shadow, {host: this});\n    // clang-format on\n  }\n}\n\nfunction renderAccountInfoOrWarning(syncInfo: Host.InspectorFrontendHostAPI.SyncInformation): LitHtml.TemplateResult {\n  if (!syncInfo.isSyncActive) {\n    return LitHtml.html`\n      <span class=\"warning\">\n        ${i18nString(UIStrings.syncDisabled)} <x-link href=\"chrome://settings/syncSetup\" class=\"link\">${\n        i18nString(UIStrings.settings)}</x-link>\n      </span>`;\n  }\n  if (!syncInfo.arePreferencesSynced) {\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    return LitHtml.html`\n      <span class=\"warning\">\n        ${i18nString(UIStrings.preferencesSyncDisabled)} <x-link href=\"chrome://settings/syncSetup/advanced\" class=\"link\">${\n        i18nString(UIStrings.settings)}</x-link>\n      </span>`;\n    // clang-format on\n  }\n  return LitHtml.html`\n    <div class=\"account-info\">\n      <img src=\"data:image/png;base64, ${syncInfo.accountImage}\" alt=\"Account avatar\" />\n      <div class=\"account-email\">\n        <span>${i18nString(UIStrings.signedIn)}</span>\n        <span>${syncInfo.accountEmail}</span>\n      </div>\n    </div>`;\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-sync-section', SyncSection);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-sync-section': SyncSection;\n  }\n}\n"]}