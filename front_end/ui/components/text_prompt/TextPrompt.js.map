{"version":3,"file":"TextPrompt.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/text_prompt/TextPrompt.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../../core/platform/platform.js';\nimport * as ComponentHelpers from '../../components/helpers/helpers.js';\nimport * as LitHtml from '../../lit-html/lit-html.js';\n\nimport textPromptStyles from './textPrompt.css.js';\n\nexport interface TextPromptData {\n  ariaLabel: string;\n  prefix: string;\n  suggestion: string;\n}\n\nexport class PromptInputEvent extends Event {\n  static readonly eventName = 'promptinputchanged';\n  data: string;\n\n  constructor(value: string) {\n    super(PromptInputEvent.eventName);\n    this.data = value;\n  }\n}\n\nexport class TextPrompt extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-text-prompt`;\n  private readonly shadow = this.attachShadow({mode: 'open'});\n  private ariaLabelText = '';\n  private prefixText = '';\n  private suggestionText = '';\n\n  connectedCallback(): void {\n    this.shadow.adoptedStyleSheets = [textPromptStyles];\n  }\n\n  set data(data: TextPromptData) {\n    this.ariaLabelText = data.ariaLabel;\n    this.prefixText = data.prefix;\n    this.suggestionText = data.suggestion;\n    this.render();\n  }\n\n  get data(): TextPromptData {\n    return {\n      ariaLabel: this.ariaLabelText,\n      prefix: this.prefixText,\n      suggestion: this.suggestionText,\n    };\n  }\n\n  focus(): void {\n    this.input().focus();\n  }\n\n  private input(): HTMLInputElement {\n    const inputElement = this.shadow.querySelector<HTMLInputElement>('input');\n    if (!inputElement) {\n      throw new Error('Expected an input element!');\n    }\n    return inputElement;\n  }\n\n  moveCaretToEndOfInput(): void {\n    this.setSelectedRange(this.text().length, this.text().length);\n  }\n\n  onInput(): void {\n    this.suggestion().textContent = this.text();\n    this.dispatchEvent(new PromptInputEvent(this.text().trim()));\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (event.key === Platform.KeyboardUtilities.ENTER_KEY) {\n      event.preventDefault();\n    }\n  }\n\n  setSelectedRange(startIndex: number, endIndex: number): void {\n    if (startIndex < 0) {\n      throw new RangeError('Selected range start must be a nonnegative integer');\n    }\n    const textContentLength = this.text().length;\n    if (endIndex > textContentLength) {\n      endIndex = textContentLength;\n    }\n    if (endIndex < startIndex) {\n      endIndex = startIndex;\n    }\n    this.input().setSelectionRange(startIndex, endIndex);\n  }\n\n  setPrefix(prefix: string): void {\n    this.prefixText = prefix;\n    this.render();\n  }\n\n  setSuggestion(suggestion: string): void {\n    this.suggestionText = suggestion;\n    this.render();\n  }\n\n  setText(text: string): void {\n    this.input().value = text;\n    this.suggestion().textContent = this.text();\n\n    if (this.input().hasFocus()) {\n      this.moveCaretToEndOfInput();\n      this.input().scrollIntoView();\n    }\n  }\n\n  private suggestion(): HTMLSpanElement {\n    const suggestionElement = this.shadow.querySelector<HTMLSpanElement>('.suggestion');\n    if (!suggestionElement) {\n      throw new Error('Expected an suggestion element!');\n    }\n    return suggestionElement;\n  }\n\n  private text(): string {\n    return this.input().value || '';\n  }\n\n  private render(): void {\n    const output = LitHtml.html`\n      <span class=\"prefix\">${this.prefixText} </span>\n      <span class=\"text-prompt-input\"><input aria-label=${this.ariaLabelText} spellcheck=\"false\" @input=${\n        this.onInput} @keydown=${this.onKeyDown}/><span class='suggestion' suggestion=\"${\n        this.suggestionText}\"></span></span>`;\n    LitHtml.render(output, this.shadow, {host: this});\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-text-prompt', TextPrompt);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-text-prompt': TextPrompt;\n  }\n\n  interface HTMLElementEventMap {\n    'promptinputchanged': PromptInputEvent;\n  }\n}\n"]}